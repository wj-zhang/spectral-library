import unittest
import spectrum_snr
import numpy as np


class SpectrumSnrTestCase(unittest.TestCase):
    """Tests for 'spectrum_snr.py'."""

    def setUp(self):
        self.masses = [95.02481842041016, 97.02877807617188, 98.06063842773438, 98.98450469970703, 101.07130432128906, 102.05528259277344, 104.05342864990234, 110.07156372070312, 111.04438018798828, 112.05085754394531, 112.08729553222656, 113.03451538085938, 113.05418395996094, 113.58711242675781, 115.08719635009766, 120.08098602294922, 127.05017852783203, 129.06607055664062, 129.10240173339844, 130.05001831054688, 130.08644104003906, 133.06085205078125, 136.06179809570312, 136.07620239257812, 137.06541442871094, 138.03746032714844, 139.15802001953125, 145.0607147216797, 147.1127471923828, 147.1234130859375, 149.02337646484375, 149.04501342773438, 150.0447540283203, 151.04153442382812, 155.08151245117188, 157.10787963867188, 159.0766143798828, 167.03411865234375, 167.05519104003906, 167.08106994628906, 168.0557098388672, 169.05279541015625, 172.07180786132812, 173.0558624267578, 175.1192169189453, 179.89044189453125, 181.06088256835938, 181.0973358154297, 183.14891052246094, 185.09222412109375, 187.0715789794922, 194.12933349609375, 195.11268615722656, 198.08775329589844, 199.0712432861328, 200.1393585205078, 201.12391662597656, 208.95318603515625, 209.09249877929688, 209.1392822265625, 210.9508514404297, 211.14341735839844, 213.08692932128906, 215.13934326171875, 215.6182403564453, 216.09861755371094, 216.12034606933594, 218.14991760253906, 219.15304565429688, 223.06362915039062, 224.06643676757812, 225.04327392578125, 226.0435333251953, 226.0826873779297, 227.0415496826172, 227.0662078857422, 232.0446014404297, 237.13548278808594, 243.13357543945312, 244.09222412109375, 245.07620239257812, 248.64724731445312, 250.0943145751953, 254.16107177734375, 255.16456604003906, 261.15753173828125, 263.1467590332031, 264.2062683105469, 267.1621398925781, 267.66668701171875, 270.0720520019531, 270.64154052734375, 283.103515625, 284.0890808105469, 284.12408447265625, 288.0832214355469, 290.184814453125, 297.15802001953125, 298.637939453125, 301.11407470703125, 302.1337890625, 305.107421875, 308.1943359375, 309.1173400878906, 315.16583251953125, 318.9222106933594, 320.9189147949219, 321.2391052246094, 323.1322021484375, 324.1189880371094, 325.6670227050781, 326.9854431152344, 333.17584228515625, 334.1813049316406, 334.6729736328125, 335.0975646972656, 339.2502136230469, 340.2558288574219, 341.0191650390625, 342.0196228027344, 343.0165100097656, 344.0168762207031, 344.9939880371094, 345.99603271484375, 348.0698547363281, 349.2341003417969, 350.23681640625, 353.1097412109375, 358.16265869140625, 359.0281982421875, 360.028564453125, 361.0263366699219, 362.0259094238281, 367.1728820800781, 367.2451171875, 368.24884033203125, 374.174560546875, 383.18145751953125, 392.1893005371094, 393.26214599609375, 394.2104187011719, 399.11639404296875, 412.21868896484375, 429.085205078125, 430.2296142578125, 430.8869934082031, 431.0889587402344, 431.2328186035156, 439.73577880859375, 439.9068908691406, 440.0718078613281, 440.2412414550781, 447.0361022949219, 448.234375, 451.26416015625, 468.2920837402344, 469.2941589355469, 476.11676025390625, 479.2586669921875, 487.2565002441406, 487.6568298339844, 496.2887268066406, 497.2889709472656, 513.4737548828125, 518.4730224609375, 518.674072265625, 518.8762817382812, 524.2772216796875, 539.3308715820312, 540.27490234375, 541.2619018554688, 542.2670288085938, 554.2821044921875, 555.03662109375, 558.2849731445312, 569.0481567382812, 585.1800537109375, 590.9908447265625, 593.3049926757812, 594.292236328125, 611.3156127929688, 612.3198852539062, 636.3226928710938, 636.8225708007812, 650.3232421875, 651.3158569335938, 668.3362426757812, 669.3391723632812, 673.3111572265625, 682.3434448242188, 694.35009765625, 711.378173828125, 730.3358154296875, 765.3524169921875, 766.3485717773438, 767.3388061523438, 782.3684692382812, 783.3638305664062, 784.3653564453125, 800.3924560546875, 801.3890380859375, 845.3566284179688, 911.4097900390625, 1007.2291259765625, 1100.7218017578125, 1349.7861328125]
        self.intensities = [3643.9434, 20864.805, 3150.0356, 49744.945, 64602.81, 68801.48, 4412.7334, 22118.564, 44962.734, 192638.7, 10895.325, 5446.2583, 4734.6567, 10111.674, 3264.7612, 5891.307, 20858.12, 14974.961, 94549.84, 17911.385, 32727.717, 20196.172, 111258.0, 5422.9023, 4256.448, 2546.054, 2974.4187, 17152.312, 74371.83, 4464.506, 321687.47, 28999.395, 5476.986, 6483.0146, 3086.2214, 19398.926, 3580.1982, 54340.42, 42226.04, 3102.2964, 5613.659, 18115.562, 4145.3965, 42507.43, 15668.241, 3489.3564, 4768.943, 4564.3545, 4512.3486, 12217.58, 3883.8137, 3437.403, 16792.494, 13498.8545, 6193.7446, 21615.99, 13209.15, 52366.633, 14008.867, 2964.1921, 17658.348, 4895.6943, 57714.95, 12451.928, 43622.902, 5593.5596, 4461.6753, 197499.88, 11735.32, 16908.19, 5390.81, 14485.062, 3528.539, 15523.082, 9859.136, 19253.56, 4405.147, 17460.494, 6532.5415, 11378.965, 4630.579, 3294.2068, 4828.175, 118236.67, 10962.832, 3812.1045, 2898.4758, 3648.09, 3949.5027, 3070.5586, 5657.093, 11919.075, 4284.904, 11511.396, 38335.984, 11329.403, 3536.4849, 3584.7053, 5374.4795, 3200.5896, 5951.0146, 2722.5154, 4297.3794, 4451.275, 12504.423, 16684.531, 45292.8, 14524.298, 5983.292, 20768.275, 4706.1616, 6529.6226, 47741.18, 4383.081, 4588.278, 10806.4375, 25399.184, 4827.058, 11966.245, 5494.644, 34184.78, 6274.234, 12496.1455, 3968.2432, 17376.87, 36977.203, 4850.3257, 6052.38, 4219.186, 62119.594, 64641.03, 308298.5, 66173.66, 3974.4937, 150304.11, 29224.795, 3645.2715, 4132.364, 6051.4253, 3613.9182, 3438.477, 5442.889, 17853.494, 3700.4773, 207404.89, 15246.081, 20952.443, 33197.113, 21802.13, 21673.043, 20568.994, 5723.744, 16438.611, 11495.006, 6269.2627, 32783.254, 9968.02, 5169.2686, 4711.9976, 3242.08, 3184.9248, 82282.8, 17836.838, 3504.1282, 14036.317, 17416.494, 14268.485, 4292.7344, 5190.252, 24080.988, 93967.56, 20439.38, 3039.4353, 3232.2544, 4688.1733, 3830.5266, 3471.5627, 3795.3484, 13775.937, 10869.184, 70458.85, 18349.666, 5349.588, 4932.8584, 17038.887, 6198.451, 66830.086, 20706.625, 16651.305, 3594.3813, 4522.6025, 5571.427, 13063.42, 37596.023, 17205.088, 3955.1692, 23781.062, 81719.37, 28056.504, 29365.574, 5367.863, 12153.936, 5864.6543, 3277.7224, 3845.1772, 4128.8716]

    def test_spectrum_snr(self):
        self.intensities = np.array(self.intensities)
        snr = spectrum_snr.spectrum_snr(self.intensities)
        self.assertAlmostEqual(snr, 97.45, places=2)


if __name__ == '__main__':
    unittest.main()
